<!--  gestao/includes/_filtros_questoes_avancado.html  -->
{% load pratica_extras %}

<style>
    @media (max-width: 767.98px) {
         .clean{
            margin-top: 5px;
         }
        }
</style>

<form method="GET" action="{{ form_action_url }}" id="form-filtros" 
      data-assuntos-url="{{ assuntos_url }}" 
      data-selected-assuntos="{{ selected_assuntos_json|safe }}"
      data-prefix="{{ prefix }}">
    
    <div class="row">
        <div class="col-12 mb-3">
            <div class="input-group">
                <span class="input-group-text"><i class="fas fa-search"></i></span>
                <input type="text" class="form-control" name="{{ prefix }}palavra_chave" placeholder="Buscar por palavra-chave ou código..." value="{{ palavra_chave_buscada }}">
            </div>
        </div>

        <div class="col-12 filtro-container">
            <!-- ✅ CORREÇÃO: Grade do Bootstrap ajustada para melhor responsividade mobile -->
            <div class="row g-2">
                <!-- Disciplina e Assunto ocupam a linha inteira em telas pequenas (col-12) -->
                <div class="col-12 col-md-6 col-lg-4">{% include 'pratica/includes/_filtro_dropdown.html' with name="disciplina" prefix=prefix label="Disciplina" items=disciplinas selected_ids=selected_disciplinas %}</div>
                <div class="col-12 col-md-6 col-lg-4">{% include 'pratica/includes/_filtro_dropdown.html' with name="assunto" prefix=prefix label="Assunto" items=None selected_ids=selected_assuntos %}</div>
                
                <!-- Outros filtros se dividem em duas colunas em telas pequenas (col-6) -->
                <div class="col-6 col-md-4 col-lg-4">{% include 'pratica/includes/_filtro_dropdown.html' with name="banca" prefix=prefix label="Banca" items=bancas selected_ids=selected_bancas %}</div>
                <div class="col-6 col-md-4 col-lg-4">{% include 'pratica/includes/_filtro_dropdown.html' with name="instituicao" prefix=prefix label="Instituição" items=instituicoes selected_ids=selected_instituicoes %}</div>
                <div class="col-6 col-md-4 col-lg-4">{% include 'pratica/includes/_filtro_dropdown.html' with name="ano" prefix=prefix label="Ano" items=anos selected_ids=selected_anos is_simple_list=True %}</div>
            </div>
        </div>
    </div>

    <div id="active-filters-container-{{ prefix }}" class="mt-4" style="display: none;"></div>
    <div class="filtro-feedback mt-4" id="filtro-feedback-container">
        <span class="text-muted">Selecione os filtros para ver o total de questões disponíveis.</span>
    </div>
    
    <div class="text-center mt-4">
        <button type="submit" class="btn btn-primary px-5"><i class="fas fa-filter me-2"></i>Aplicar Filtros</button>
        <a href="{{ form_action_url }}" class="btn btn-outline-secondary px-4 ms-2 clean">Limpar</a>
    </div>
</form>