<!-- gestao/includes/_item_log_atividade.html -->
{% load log_extras %}

<div class="log-item position-relative" id="log-item-{{ log.id }}">
    <!-- Checkbox -->
    <div class="pt-1">
        {% if log.ator != request.user %}
            <input class="form-check-input log-checkbox" type="checkbox" data-id="{{ log.id }}">
        {% endif %}
    </div>

    <!-- Ícone -->
    <div class="log-icon pt-1"><i class="{{ log|get_log_icon }}"></i></div>

    <!-- Conteúdo Principal -->
    <div class="flex-grow-1">
        <div class="d-flex justify-content-between align-items-start flex-wrap gap-2 log-main-info">
            <!-- Mensagem -->
            <p class="log-message">{{ log|generate_log_message|safe }}</p>
            <!-- Data -->
            <div class="log-meta text-nowrap">
                <span title="{{ log.data_criacao|date:'d/m/Y H:i:s' }}"><i class="far fa-clock me-1"></i>{{ log.data_criacao|date:"d/m/Y, H:i" }}</span>
            </div>
        </div>

        {% with reason=log.detalhes|format_log_reason %}
            {% if reason %}
                <div class="mt-2">
                    <blockquote class="log-reason-details">{{ reason }}</blockquote>
                </div>
            {% endif %}
        {% endwith %}
    </div>

    <!-- Botão de Ação -->
    <div class="pt-1 log-actions">
        {% if log.ator != request.user %}
            <button type="button" class="btn btn-sm btn-outline-danger btn-delete-log" data-log-id="{{ log.id }}" data-bs-toggle="tooltip" data-bs-placement="left" title="Mover para lixeira">
                <i class="fas fa-trash-alt"></i>
            </button>
        {% else %}
            <!-- ======================================================= -->
            <!-- INÍCIO DA CORREÇÃO: Tooltip em botão desabilitado     -->
            <!-- ======================================================= -->
            <span class="d-inline-block" tabindex="0" data-bs-toggle="tooltip" data-bs-placement="left" title="Você não pode excluir seus próprios registros.">
                <button type="button" class="btn btn-sm btn-secondary" disabled style="pointer-events: none;"><i class="fas fa-trash-alt"></i></button>
            </span>
            <!-- ======================================================= -->
            <!-- FIM DA CORREÇÃO                                         -->
            <!-- ======================================================= -->
        {% endif %}
    </div>
</div>