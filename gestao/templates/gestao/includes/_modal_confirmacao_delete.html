<!-- gestao/templates/gestao/includes/_modal_confirmacao_delete.html -->

<div class="modal fade" id="confirmDeleteModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title"><i class="fas fa-exclamation-triangle me-2"></i>Confirmar Exclusão</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Você tem certeza que deseja excluir o item <strong id="itemName" class="text-danger"></strong>?</p>
                <p class="text-muted small">Esta ação não pode ser desfeita.</p>
            </div>
            <div class="modal-footer">
                <form id="deleteForm" method="POST" action="">
                    {% csrf_token %}
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="submit" class="btn btn-danger">Sim, Excluir</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
// Adicionamos o script de controle aqui para que ele seja incluído junto com o modal.
// Isso garante que a lógica esteja sempre presente quando o modal for usado.
document.addEventListener('DOMContentLoaded', function () {
    const confirmDeleteModal = document.getElementById('confirmDeleteModal');
    if (confirmDeleteModal) {
        confirmDeleteModal.addEventListener('show.bs.modal', function (event) {
            const button = event.relatedTarget; // Botão que acionou o modal
            if (button) {
                const deleteUrl = button.getAttribute('data-delete-url');
                const itemName = button.getAttribute('data-item-name');
                
                const modalBodyName = confirmDeleteModal.querySelector('#itemName');
                const deleteForm = confirmDeleteModal.querySelector('#deleteForm');
                
                if (modalBodyName) {
                    modalBodyName.textContent = `"${itemName}"`;
                }
                if (deleteForm) {
                    deleteForm.setAttribute('action', deleteUrl);
                }
            }
        });
    }
});
</script>