<!-- templates/home.html -->
{% extends 'base.html' %}
{% load static %}

{% block title %}A Ferramenta Definitiva para a Sua Aprovação{% endblock %}

{% block head %}
<style>
    /* ======================================================================= */
    /* ✅ INÍCIO DA ATUALIZAÇÃO: DESIGN COM TRANSIÇÃO SUAVE
    /* ======================================================================= */

    /* --- ESTILOS GERAIS PARA AS SEÇÕES --- */
    section {
        position: relative;
        padding: 6rem 0;
    }
    
    html, body {
        overflow-x: hidden;
    }

    /* --- SEÇÃO HERO --- */
    .hero-section {
        background: linear-gradient(135deg, rgba(26, 31, 61, 0.9) 0%, rgba(41, 47, 90, 0.95) 100%), url('{% static "img/background.jpg" %}');
        background-size: cover;
        background-position: center;
        color: white;
        padding: 8rem 0; /* Padding inferior ajustado */
        text-align: center;
        /* Efeito de máscara/sombra removido */
    }
    .hero-section h1 {
        font-family: 'Oxanium', sans-serif;
        font-weight: 700;
        font-size: 4rem;
        color: var(--cor-dourada);
        text-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    }
    .hero-section .lead {
        font-size: 1.25rem;
        font-weight: 400;
        opacity: 0.9;
        max-width: 700px;
        margin-left: auto;
        margin-right: auto;
        text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }

    /* --- SEÇÃO DE RECURSOS --- */
    .features-section {
        background-color: var(--cor-fundo-body);
        padding: 8rem 0;
    }
    .feature-card {
        border: none;
        border-radius: var(--raio-borda);
        box-shadow: var(--sombra-caixa);
        transition: var(--transicao-padrao);
        background-color: var(--cor-fundo-claro);
    }
    .feature-card:hover {
        transform: translateY(-10px);
        box-shadow: var(--sombra-caixa-hover);
    }
    .feature-icon {
        font-size: 2.8rem;
        width: 80px;
        height: 80px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background-image: linear-gradient(135deg, var(--cor-primaria), var(--cor-primaria-escura));
        color: white;
        margin-bottom: 1.5rem;
        box-shadow: 0 8px 20px rgba(141, 118, 198, 0.3);
    }

    /* --- SEÇÃO DE ESTATÍSTICAS --- */
    .stats-section {
        background-color: var(--cor-fundo-escuro);
        color: white;
        padding: 8rem 0;
    }
    .stats-section .section-title {
        color: var(--cor-dourada);
    }
    .stat-item .display-4 {
        font-family: 'Oxanium', sans-serif;
        font-weight: 700;
        color: var(--cor-dourada);
    }
    .stat-item .stat-label {
        font-size: 1.15rem;
        opacity: 0.8;
    }
    .stat-item .stat-icon {
        color: var(--cor-primaria);
        opacity: 0.7;
    }

    /* --- SEÇÃO GAMIFICAÇÃO (NOVOS ESTILOS) --- */
    .gamification-showcase-section {
        background-color: var(--cor-fundo-body);
        padding: 8rem 0;
    }
    .gamification-showcase-section .section-title {
        color: var(--cor-texto-escuro);
    }
    .gamification-card {
        background-color: var(--cor-fundo-claro);
        border: 1px solid var(--cor-borda);
        border-radius: var(--raio-borda);
        box-shadow: var(--sombra-caixa);
        transition: var(--transicao-padrao);
        overflow: hidden;
    }
    .gamification-card:hover {
        transform: translateY(-8px);
        box-shadow: var(--sombra-caixa-hover);
    }
    .gamification-card .card-img-container {
        position: relative;
    }
    .gamification-card .card-img-top {
        height: 200px;
        object-fit: cover;
        object-position: top;
        border-bottom: 1px solid var(--cor-borda);
    }
    .view-full-image-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        opacity: 0;
        transition: var(--transicao-padrao);
        background-color: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(4px);
        border-radius: 50%;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0;
        border: none;
    }
    .gamification-card:hover .view-full-image-btn {
        opacity: 1;
    }
    .gamification-card .card-body {
        padding: 1.5rem;
        text-align: center;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }
    .gamification-card .card-title {
        font-size: 1.5rem;
        font-family: var(--fonte-display);
        color: var(--cor-primaria-escura);
        margin-bottom: 0.75rem;
    }
    .gamification-card .card-text {
        color: var(--cor-texto-muted);
        font-size: 0.95rem;
        line-height: 1.5;
        flex-grow: 1;
    }
    .gamification-card .btn {
        margin-top: 1rem;
    }

    /* --- SEÇÃO CTA FINAL --- */
    .cta-section {
        background: linear-gradient(135deg, var(--cor-primaria), var(--cor-primaria-escura));
        color: white;
        padding: 6rem 0; /* Padding padrão */
        position: relative;
        margin-bottom: -100px; /* Para garantir a fusão sem linhas finas */
    }
    .cta-section h2 {
        color: white;
    }


    /* Estilo para o botão de fechar do modal */
#imageModal .btn-close {
    background-color: rgba(0, 0, 0, 0.6) !important; /* fundo escuro semi-transparente */
    border-radius: 50%; /* botão arredondado */
    width: 2rem;
    height: 2rem;
    opacity: 1; /* sempre visível */
}

#imageModal .btn-close::after {
    content: "×"; /* força um X legível */
    font-size: 1.5rem;
    color: #fff; /* branco para contraste */
    font-weight: bold;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

    /* --- AJUSTES DE RESPONSIVIDADE --- */
    @media (max-width: 768px) {
        .hero-section h1 {
            font-size: 2.8rem;
        }
        section {
            padding: 4rem 0;
        }
        .hero-section {
            padding: 6rem 0;
        }
        .stats-section, .features-section, .gamification-showcase-section {
            padding: 6rem 0;
        }
        .cta-section {
            padding: 4rem 0;
        }
        .gamification-card .card-img-top {
            height: 160px;
        }
    }

    /* ======================================================================= */
    /* FIM DA ATUALIZAÇÃO
    /* ======================================================================= */
</style>
{% endblock %}

{% block content %}
<!-- Seção Hero -->
<section class="hero-section">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-9">
                <h1 class="display-3 mb-4">Sua Jornada Rumo à Aprovação Começa Aqui</h1>
                <p class="lead mb-5">Domine um arsenal de <strong>{{ total_questoes|default:"milhares de" }}</strong> questões, filtre com precisão e analise seu desempenho com estatísticas detalhadas para acelerar sua jornada.</p>
                <div class="d-grid gap-3 d-sm-flex justify-content-sm-center">
                    {% if user.is_authenticated %}
                        <a href="{% url 'pratica:listar_questoes' %}" class="btn btn-primary btn-lg px-5 py-3">Iniciar Treinamento</a>
                        <a href="{% url 'dashboard' %}" class="btn btn-light btn-lg px-5 py-3">Meu Desempenho</a>
                    {% else %}
                        <a href="{% url 'cadastro' %}" class="btn btn-primary btn-lg px-5 py-3">Crie sua Conta Grátis</a>
                        <a href="{% url 'login' %}" class="btn btn-outline-light btn-lg px-5 py-3">Fazer Login</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Seção de Recursos -->
<section class="features-section">
    <div class="container">
        <div class="text-center mb-5 pb-3">
            <h2 class="h2">Uma Plataforma Completa</h2>
            <p class="text-muted lead">Tudo o que você precisa para estudar de forma eficiente.</p>
        </div>
        <div class="row g-4 justify-content-center">
            <div class="col-lg-3 col-md-6"><div class="card feature-card h-100 text-center p-4"><div class="feature-icon mx-auto"><i class="fas fa-pencil-alt"></i></div><h5 class="card-title h4">Pratique</h5><p class="card-text text-muted">Resolva milhares de questões com filtros avançados por disciplina, assunto, banca e mais.</p></div></div>
            <div class="col-lg-3 col-md-6"><div class="card feature-card h-100 text-center p-4"><div class="feature-icon mx-auto"><i class="fas fa-file-alt"></i></div><h5 class="card-title h4">Simule</h5><p class="card-text text-muted">Crie simulados personalizados ou resolva provas oficiais para testar seus conhecimentos.</p></div></div>
            <div class="col-lg-3 col-md-6"><div class="card feature-card h-100 text-center p-4"><div class="feature-icon mx-auto"><i class="fas fa-chart-pie"></i></div><h5 class="card-title h4">Analise</h5><p class="card-text text-muted">Acompanhe seu desempenho com gráficos detalhados, identificando pontos fortes e fracos.</p></div></div>
            <div class="col-lg-3 col-md-6"><div class="card feature-card h-100 text-center p-4"><div class="feature-icon mx-auto"><i class="fas fa-trophy"></i></div><h5 class="card-title h4">Compita</h5><p class="card-text text-muted">Participe de rankings, desbloqueie conquistas e personalize seu perfil com recompensas.</p></div></div>
        </div>
    </div>
</section>

<!-- Seção de Estatísticas -->
<section class="stats-section">
    <div class="container">
        <div class="text-center mb-5 pb-3">
            <h2 class="h2 section-title">Nossa Comunidade em Números</h2>
        </div>
        <div class="row text-center">
            <div class="col-md-4 mb-5 mb-md-0 stat-item"><i class="fas fa-book-open fa-3x mb-3 stat-icon"></i><h3 class="display-4">{{ total_questoes|default:"250k+" }}</h3><p class="stat-label">Questões Cadastradas</p></div>
            <div class="col-md-4 mb-5 mb-md-0 stat-item"><i class="fas fa-users fa-3x mb-3 stat-icon"></i><h3 class="display-4">{{ total_usuarios|default:"15k+" }}</h3><p class="stat-label">Usuários Ativos</p></div>
            <div class="col-md-4 stat-item"><i class="fas fa-check-double fa-3x mb-3 stat-icon"></i><h3 class="display-4">{{ total_simulados_concluidos|default:"500k+" }}</h3><p class="stat-label">Simulados Realizados</p></div>
        </div>
    </div>
</section>

<!-- Nova Seção de Gamificação com Cards Responsivos -->
<section class="gamification-showcase-section">
    <div class="container">
        <div class="text-center mb-5 pb-3">
            <h2 class="h2 section-title">Um Universo de Gamificação</h2>
            <p class="text-muted lead">Transforme seus estudos em uma aventura épica e seja recompensado por cada passo.</p>
        </div>
        <div class="row g-4 justify-content-center">

            <div class="col-lg-4 col-md-6">
                <div class="card gamification-card h-100">
                    <div class="card-img-container">
                        <img src="{% static 'img/gamification/perfil.png' %}" class="card-img-top" alt="Perfil de Estudante Personalizado">
                        <button class="view-full-image-btn" data-bs-toggle="modal" data-bs-target="#imageModal" data-img-url="{% static 'img/gamification/perfil.png' %}"><i class="fas fa-expand-alt"></i></button>
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">Perfil de Estudante</h5>
                        <p class="card-text">Seu santuário pessoal, onde você exibe seu nível, suas conquistas e os artefatos que colecionou.</p>
                        {% if user.is_authenticated %}<a href="{% url 'meu_perfil' %}" class="btn btn-sm btn-outline-primary">Ver Meu Perfil</a>{% else %}<a href="{% url 'cadastro' %}" class="btn btn-sm btn-primary">Comece Agora</a>{% endif %}
                    </div>
                </div>
            </div>

            <div class="col-lg-4 col-md-6">
                <div class="card gamification-card h-100">
                    <div class="card-img-container">
                        <img src="{% static 'img/gamification/ranking.png' %}" class="card-img-top" alt="Rankings Competitivos">
                        <button class="view-full-image-btn" data-bs-toggle="modal" data-bs-target="#imageModal" data-img-url="{% static 'img/gamification/ranking.png' %}"><i class="fas fa-expand-alt"></i></button>
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">Rankings Competitivos</h5>
                        <p class="card-text">Meça sua força contra outros estudantes nos rankings geral, mensal e semanal. A glória o aguarda!</p>
                        {% if user.is_authenticated %}<a href="{% url 'gamificacao:ranking' %}" class="btn btn-sm btn-outline-primary">Ver Rankings</a>{% else %}<a href="{% url 'cadastro' %}" class="btn btn-sm btn-primary">Comece Agora</a>{% endif %}
                    </div>
                </div>
            </div>

            <div class="col-lg-4 col-md-6">
                <div class="card gamification-card h-100">
                    <div class="card-img-container">
                        <img src="{% static 'img/gamification/trilhas.png' %}" class="card-img-top" alt="Trilhas de Conquistas">
                        <button class="view-full-image-btn" data-bs-toggle="modal" data-bs-target="#imageModal" data-img-url="{% static 'img/gamification/trilhas.png' %}"><i class="fas fa-expand-alt"></i></button>
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">Trilhas de Conquistas</h5>
                        <p class="card-text">Embarque em jornadas desafiadoras, cumpra objetivos e desbloqueie medalhas por sua dedicação.</p>
                        {% if user.is_authenticated %}<a href="{% url 'trilhas_de_conquistas' %}" class="btn btn-sm btn-outline-primary">Ver Trilhas</a>{% else %}<a href="{% url 'cadastro' %}" class="btn btn-sm btn-primary">Comece Agora</a>{% endif %}
                    </div>
                </div>
            </div>

            <div class="col-lg-4 col-md-6">
                <div class="card gamification-card h-100">
                    <div class="card-img-container">
                        <img src="{% static 'img/gamification/loja.png' %}" class="card-img-top" alt="Arsenal Divino (Loja)">
                        <button class="view-full-image-btn" data-bs-toggle="modal" data-bs-target="#imageModal" data-img-url="{% static 'img/gamification/loja.png' %}"><i class="fas fa-expand-alt"></i></button>
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">Arsenal Divino (Loja)</h5>
                        <p class="card-text">Use seus "Fragmentos de Conhecimento" para adquirir avatares, bordas e banners exclusivos.</p>
                        {% if user.is_authenticated %}<a href="{% url 'gamificacao:loja' %}" class="btn btn-sm btn-outline-primary">Visitar Arsenal</a>{% else %}<a href="{% url 'cadastro' %}" class="btn btn-sm btn-primary">Comece Agora</a>{% endif %}
                    </div>
                </div>
            </div>

            <div class="col-lg-4 col-md-6">
                <div class="card gamification-card h-100">
                    <div class="card-img-container">
                        <img src="{% static 'img/gamification/recompensa.png' %}" class="card-img-top" alt="Câmara dos Tesouros">
                        <button class="view-full-image-btn" data-bs-toggle="modal" data-bs-target="#imageModal" data-img-url="{% static 'img/gamification/recompensa.png' %}"><i class="fas fa-expand-alt"></i></button>
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">Câmara dos Tesouros</h5>
                        <p class="card-text">Todos os prêmios que você ganha em eventos e ao subir de nível esperam por você aqui para serem revelados.</p>
                        {% if user.is_authenticated %}<a href="{% url 'caixa_de_recompensas' %}" class="btn btn-sm btn-outline-primary">Minha Câmara</a>{% else %}<a href="{% url 'cadastro' %}" class="btn btn-sm btn-primary">Comece Agora</a>{% endif %}
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4 col-md-6">
                <div class="card gamification-card h-100">
                    <div class="card-img-container">
                        <img src="{% static 'img/gamification/avatar.png' %}" class="card-img-top" alt="Coleção de Artefatos">
                        <button class="view-full-image-btn" data-bs-toggle="modal" data-bs-target="#imageModal" data-img-url="{% static 'img/gamification/avatar.png' %}"><i class="fas fa-expand-alt"></i></button>
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">Coleção de Artefatos</h5>
                        <p class="card-text">Organize e exiba todos os avatares, bordas e banners que você já desbloqueou em sua jornada.</p>
                        {% if user.is_authenticated %}<a href="{% url 'colecao_avatares' %}" class="btn btn-sm btn-outline-primary">Minha Coleção</a>{% else %}<a href="{% url 'cadastro' %}" class="btn btn-sm btn-primary">Comece Agora</a>{% endif %}
                    </div>
                </div>
            </div>

        </div>
    </div>
</section>

<!-- Seção de CTA Final -->
<section class="cta-section text-center">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <h2 class="h2 mb-3">Pronto para Começar?</h2>
                <p class="lead mb-4">Junte-se a milhares de estudantes e dê o próximo passo em direção à sua aprovação. O cadastro é rápido e gratuito.</p>
                <a href="{% url 'cadastro' %}" class="btn btn-light btn-lg px-5 py-3">Criar Minha Conta Agora</a>
            </div>
        </div>
    </div>
</section>

<!-- Modal para Visualização de Imagem -->
<div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content bg-transparent border-0">
      <div class="modal-body p-0 position-relative">
        <img src="" id="modalImage" class="img-fluid rounded shadow-lg" alt="Visualização completa">
        <button type="button" class="btn-close btn-close-white position-absolute top-0 end-0 m-3" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function () {
  const imageModal = document.getElementById('imageModal');
  if (imageModal) {
    imageModal.addEventListener('show.bs.modal', function (event) {
      const button = event.relatedTarget; // Botão que acionou o modal
      const imageUrl = button.getAttribute('data-img-url');
      const modalImageEl = document.getElementById('modalImage');
      modalImageEl.src = imageUrl;
    });
  }
});
</script>
{% endblock %}